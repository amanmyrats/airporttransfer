<section class="car-selection">
  <header class="car-selection__header">
    <div class="car-selection__heading">
      <span class="car-selection__badge">{{ translations.cars[langInput.code] }}</span>
      <h1>{{ translations.bookYourRide ? translations.bookYourRide[langInput.code] : translations.cars[langInput.code] }}</h1>
    </div>
    <div class="car-selection__route" *ngIf="bookingService.bookingInitialForm.value.pickup_full || bookingService.bookingInitialForm.value.dest_full">
      <div class="route-chip">
        <span class="route-icon" aria-hidden="true">üìç</span>
        <span class="route-text">{{ bookingService.bookingInitialForm.value.pickup_full }}</span>
      </div>
      <span class="route-arrow" aria-hidden="true">‚ûú</span>
      <div class="route-chip route-chip--destination">
        <span class="route-icon" aria-hidden="true">üèÅ</span>
        <span class="route-text">{{ bookingService.bookingInitialForm.value.dest_full }}</span>
      </div>
    </div>
    <div class="car-selection__metrics">
      <div class="metric">
        <span class="metric-icon" aria-hidden="true">üõ£Ô∏è</span>
        <span class="metric-label">{{ translations.distance[langInput.code] }}</span>
        <strong class="metric-value">{{ bookingService.bookingCarTypeSelectionForm.value.distance | number: '1.0-0' }} km</strong>
      </div>
      <div class="metric">
        <span class="metric-icon" aria-hidden="true">‚è±Ô∏è</span>
        <span class="metric-label">{{ translations.duration?.[langInput.code] || 'Duration' }}</span>
        <strong class="metric-value">{{ bookingService.bookingCarTypeSelectionForm.value.driving_duration | number: '1.0-0' }} mins</strong>
      </div>
    </div>
  </header>

  <div class="car-selection__notices">
    <div class="car-selection__notice" *ngIf="!isValidDistance()">
      <h2>{{ translations.contact[langInput.code] }}</h2>
      <p>{{ translations.invalidDistanceMessage[langInput.code] }}</p>
      <ul class="contact-links">
        <li>
          <span aria-hidden="true">üí¨</span>
          <a [href]="socialIcons.whatsapp.url" target="_blank" rel="noopener">WhatsApp {{ socialIcons.phone.formatted }}</a>
        </li>
        <li>
          <span aria-hidden="true">üì®</span>
          <a [href]="socialIcons.telegram.url" target="_blank" rel="noopener">Telegram &#64;{{ socialIcons.telegram.username }}</a>
        </li>
      </ul>
    </div>

    <div class="car-selection__notice car-selection__notice--highlight" *ngIf="isLongDistance()">
      <h2>{{ translations.specialPrice[langInput.code] }}</h2>
      <p>{{ translations.longDistanceMessage[langInput.code] }}</p>
      <ul class="contact-links">
        <li>
          <span aria-hidden="true">üí¨</span>
          <a [href]="socialIcons.whatsapp.url" target="_blank" rel="noopener">WhatsApp {{ socialIcons.phone.formatted }}</a>
        </li>
        <li>
          <span aria-hidden="true">üì®</span>
          <a [href]="socialIcons.telegram.url" target="_blank" rel="noopener">Telegram &#64;{{ socialIcons.telegram.username }}</a>
        </li>
      </ul>
    </div>
  </div>

  <div class="car-grid" *ngIf="isValidDistance() && !isLongDistance()">
    <article class="car-card" *ngFor="let carType of calculatedPrices()">
      <figure class="car-card__media">
        <img
          class="car-card__image"
          [src]="'images/cartypes/' + carType.image.name[languageService.currentLang().code]"
          [alt]="carType.image.alt[languageService.currentLang().code]"
        />
      </figure>
      <div class="car-card__content">
        <header class="car-card__header">
          <div class="car-card__title">
            <h2>{{ carType.name }}</h2>
            <span class="car-card__subtitle">{{ translations.orEquivalent?.[langInput.code] || 'or equivalent' }}</span>
          </div>
          <p class="car-card__capacity">
            <span aria-hidden="true">üë•</span>
            {{ carType.pax }} {{ translations.passengers?.[langInput.code] || 'Passengers' }}
          </p>
        </header>

        <section class="car-card__body">
          <!-- <p class="car-card__description" *ngIf="carType.code">{{ carType.code }}</p> -->

          <ng-container *ngIf="carType.specialPrice; else standardPrice">
            <div class="car-card__special">
              <span class="car-card__special-label">{{ translations.specialPrice[langInput.code] }}</span>
              <!-- <p>{{ translations.longDistanceMessage[langInput.code] }}</p> -->
              <ul class="contact-links contact-links--inline">
                <li>
                  <span aria-hidden="true">üí¨</span>
                  <a [href]="socialIcons.whatsapp.url" target="_blank" rel="noopener">WhatsApp {{ socialIcons.phone.formatted }}</a>
                </li>
                <li>
                  <span aria-hidden="true">üì®</span>
                  <a [href]="socialIcons.telegram.url" target="_blank" rel="noopener">Telegram &#64;{{ socialIcons.telegram.username }}</a>
                </li>
                <li>
                  <span aria-hidden="true">‚úâÔ∏è</span>
                  <a [href]="'mailto:' + socialIcons.email.info">{{ socialIcons.email.info }}</a>
                </li>
              </ul>
            </div>
          </ng-container>

          <ng-template #standardPrice>
            <div class="car-card__price">
              <span class="price-label">{{ translations.price[langInput.code] }}</span>
              <span class="price-value">{{ carType.price }} {{ currencyService.currentCurrency().sign }}</span>
            </div>
          </ng-template>
        </section>

        <footer class="car-card__footer" *ngIf="!carType.specialPrice">
          <button
            type="button"
            class="car-card__cta"
            (click)="onCarTypeSelection(
              carType,
              carType.price,
              currencyService.currentCurrency().code!,
              bookingService.bookingCarTypeSelectionForm.value.distance
            )"
          >
            {{ translations.select[langInput.code] }}
          </button>
        </footer>
      </div>
    </article>
  </div>
</section>

<section class="fixed-price-section">
  <h3>{{ translations.fixedPrices[langInput.code] }}</h3>
  <app-price-list [langInput]="langInput"></app-price-list>
</section>
