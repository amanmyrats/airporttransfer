<div class="dashboard">
  <h2>Welcome back, {{ user()?.first_name || user()?.email }}</h2>
  <div class="cards">
    <p-card header="Upcoming reservations">
      <ng-container *ngIf="upcomingLoading(); else upcomingLoaded">
        <p class="card-placeholder">Loading upcoming reservations…</p>
      </ng-container>
      <ng-template #upcomingLoaded>
        <ng-container *ngIf="upcomingReservations().length; else noUpcoming">
          <ul class="reservation-list">
            <li *ngFor="let reservation of upcomingReservations(); trackBy: trackByReservationId">
              <a [routerLink]="reservationLink(reservation)" class="reservation-link">
                <div class="reservation-title">{{ tripTitle(reservation) }}</div>
                <div class="reservation-meta">
                  <span>{{ transferDateLabel(reservation) }}</span>
                  <span>• {{ statusLabel(reservation.status) }}</span>
                </div>
              </a>
            </li>
          </ul>
        </ng-container>
      </ng-template>
      <ng-template #noUpcoming>
        <p>No upcoming reservations yet. Book your next transfer!</p>
      </ng-template>
    </p-card>

    <p-card header="Pending confirmation">
      <ng-container *ngIf="pendingLoading(); else pendingLoaded">
        <p class="card-placeholder">Loading pending confirmations…</p>
      </ng-container>
      <ng-template #pendingLoaded>
        <ng-container *ngIf="pendingConfirmationReservations().length; else noPending">
          <ul class="reservation-list">
            <li *ngFor="let reservation of pendingConfirmationReservations(); trackBy: trackByReservationId">
              <a [routerLink]="reservationLink(reservation)" class="reservation-link">
                <div class="reservation-title">{{ tripTitle(reservation) }}</div>
                <div class="reservation-meta">
                  <span>{{ transferDateLabel(reservation) }}</span>
                  <span>• {{ statusLabel(reservation.status) }}</span>
                </div>
              </a>
            </li>
          </ul>
        </ng-container>
      </ng-template>
      <ng-template #noPending>
        <p>All reservations are confirmed.</p>
      </ng-template>
    </p-card>

    <p-card header="Profile completeness">
      <p>
        {{ user()?.customer_profile?.preferred_language | uppercase }} • Marketing opt-in:
        {{ user()?.customer_profile?.marketing_opt_in ? 'Yes' : 'No' }}
      </p>
    </p-card>
  </div>
</div>
