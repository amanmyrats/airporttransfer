<div class="booking-box">
  <h3>{{ translations.bookNowTitle[langInput.code] }}</h3>

  <form class="reservation-form" 
        (ngSubmit)="onSubmit()" 
        [formGroup]="bookingService.bookingInitialForm">

    <div
      *ngIf="mapsStatus.status !== 'ready'"
      class="maps-overlay"
      role="status"
      [attr.aria-live]="mapsStatus.status === 'loading' ? 'polite' : 'assertive'"
    >
      <div class="maps-overlay__content">
        <div class="maps-overlay__spinner" aria-hidden="true"></div>
        <p *ngIf="mapsStatus.status === 'loading'">
          {{ translations.mapsLoading[langInput.code] }}
        </p>
        <p *ngIf="mapsStatus.status === 'failed'">
          {{ translations.mapsError[langInput.code] }}
        </p>
      </div>
    </div>

    <!-- Pickup -->
    <div class="form-group input-with-clear">
      <label for="pickup-location">
        {{ translations.pickUp[langInput.code] }}
      </label>
      <div class="input-wrapper">
        <input type="text"
               id="pickup-location"
               formControlName="pickup_full"
               placeholder="{{ translations.pickUpPlaceHolder[langInput.code] }}"
               appGmapsAutocomplete
               (placeChanged)="onPickupPlaceChanged($event)"
               (keydown)="preventFormSubmit($event)" />
        <button *ngIf="isMapsReady && bookingService.bookingInitialForm.get('pickup_full')?.value"
                type="button"
                class="clear-btn"
                (click)="clearField('pickup_full')"
                [disabled]="!isMapsReady">×</button>
      </div>
    </div>

    <!-- Dropoff -->
    <div class="form-group input-with-clear">
      <label for="dropoff-location">
        {{ translations.dropOff[langInput.code] }}
      </label>
      <div class="input-wrapper">
        <input type="text"
               id="dropoff-location"
               formControlName="dest_full"
               placeholder="{{ translations.dropOffPlaceHolder[langInput.code] }}"
               appGmapsAutocomplete
               (placeChanged)="onDestPlaceChanged($event)"
               (keydown)="preventFormSubmit($event)" />
        <button *ngIf="isMapsReady && bookingService.bookingInitialForm.get('dest_full')?.value"
                type="button"
                class="clear-btn"
                (click)="clearField('dest_full')"
                [disabled]="!isMapsReady">×</button>
      </div>
    </div>

    <!-- Submit -->
    <button
      type="submit"
      class="submit-btn"
      [class.submit-btn--loading]="isBookNowLoading"
      [disabled]="!isMapsReady || isBookNowLoading"
      [attr.aria-busy]="isBookNowLoading"
    >
      <span class="submit-btn__spinner" aria-hidden="true" *ngIf="isBookNowLoading"></span>
      <span class="submit-btn__label">
        {{ translations.bookNow[langInput.code] }}
        <svg *ngIf="!isBookNowLoading" viewBox="0 0 24 24" aria-hidden="true">
          <path d="m19.71 11.29-6-6a1 1 0 0 0-1.42 1.42L16.59 11H5a1 1 0 0 0 0 2h11.59l-4.29 4.29a1 1 0 1 0 1.42 1.42l6-6a1 1 0 0 0-.01-1.42Z" />
        </svg>
      </span>
    </button>
  </form>

  <p class="footer-note">✓ Instant confirmation · Free cancellation</p>
</div>
