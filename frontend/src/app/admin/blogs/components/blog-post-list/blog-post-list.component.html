<app-filter-search [first]="first" [rows]="rows" (searchEmitter)="search($event)">
</app-filter-search>

<div class="blog-posts-wrapper">
  <div class="header">
    <h2>Blog Posts</h2>
    <a [routerLink]="['/admin/blog-posts/categories']" style="text-decoration: none;" pButton
      class="p-button-text p-button-md">

      <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" class="bi bi-tags"
        viewBox="0 0 16 16">
        <path
          d="M3 2v4a1 1 0 0 0 1 1h4l5.5-5.5a1 1 0 0 0-1.414-1.414L7.586 4H4a1 1 0 0 0-1 1zm9.5 3a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z" />
        <path
          d="M1.293 7.793A1 1 0 0 1 .586 7L7.586.707a1 1 0 0 1 1.414 0l6.647 6.646a1 1 0 0 1 .207.327l.853 2.561a1 1 0 0 1-.207.958l-6.647 6.646a1 1 0 0 1-1.414 0L.586 8.707a1 1 0 0 1-.293-.914zm7.303-6.086L2 .707l-.647.646L7.95 8.293l.647-.646L8.596 7l-.647-.646zM2.5 9.207l6.647-6.646L14.5 7l-6.647 6.646L2.5 9.207z" />
      </svg> See All Categories
    </a>

    <a [routerLink]="['/admin/blog-posts/tags']" style="text-decoration: none;" pButton
      class="p-button-text p-button-md">

      <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" class="bi bi-tags-fill"
        viewBox="0 0 16 16">
        <path
          d="M2 2a1 1 0 0 1 1-1h4.586a1 1 0 0 1 .707.293l6.414 6.414a1 1 0 0 1 0 1.414l-4.586 4.586a1 1 0 0 1-1.414 0L2.293 7.707A1 1 0 0 1 2 7V2zm3.5 1a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3z" />
        <path
          d="M1.293 7.793A1 1 0 0 1 .586 7L7.586.707a1 1 0 0 1 1.414 0l6.647 6.646a1 1 0 0 1 .207.327l.853 2.561a1 1 0 0 1-.207.958l-6.647 6.646a1 1 0 0 1-1.414 0L.586 8.707a1 1 0 0 1-.293-.914zm7.303-6.086L2 .707l-.647.646L7.95 8.293l.647-.646L8.596 7l-.647-.646zM2.5 9.207l6.647-6.646L14.5 7l-6.647 6.646L2.5 9.207z" />
      </svg> See All Tags
    </a>

    <p-button class="p-button-secon" [label]="'Add New Post'" [rounded]="true" size="small" (click)="openForm()">
      <ng-template pTemplate="icon">
        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" class="bi bi-plus"
          viewBox="0 0 16 16">
          <path
            d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z" />
        </svg>

      </ng-template>
    </p-button>

  </div>

  <p-table [value]="blogPosts" responsiveLayout="scroll" class="p-datatable-sm">
    <ng-template pTemplate="header">
      <tr>
        <th>Title</th>
        <th>Category</th>
        <th>Tags</th>
        <th>Status</th>
        <th>Views</th>
        <th>Published At</th>
        <th>Actions</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-post>
      <tr>
        <td>
          {{ post.internal_title || post.slug }}
        </td>
        <td>{{ getCategoryLabel(post.category_obj) || '—' }}</td>
        <td>{{ getTagLabels(post.tags_obj) || '—' }}</td>
        <td>
          <span [class.p-badge]="true" [class.p-badge-success]="post.is_published"
            [class.p-badge-secondary]="!post.is_published">
            {{ post.is_published ? 'Published' : 'Draft' }}
          </span>
          <br>
          <span *ngIf="post.author">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16">
              <path fill="currentColor" d="M12 12a5 5 0 1 0-5-5 5 5 0 0 0 5 5zm0 2c-4.42 0-8 2.24-8 5v1h16v-1c0-2.76-3.58-5-8-5z"/>
            </svg> {{ post.author }}
          </span>
        </td>
        <td>{{ post.views_count }}</td>
        <td>{{ post.published_at || '-' }}</td>
        <td class="action-buttons">

          <button (click)="openForm(post)" pButton class="p-button-text p-button-lg">

            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" class="bi bi-pencil"
              viewBox="0 0 16 16">
              <path
                d="M12.146.854a.5.5 0 0 1 .708 0l2.292 2.292a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168l10-10zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207 11.207 2.5zM10.5 3.207 2 11.707V14h2.293l8.5-8.5-2.293-2.293z" />
            </svg>
          </button>



          <button (click)="deleteObj(post.id!)" pButton class="p-button-text p-button-lg">
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" class="bi bi-trash"
              viewBox="0 0 16 16">
              <path
                d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5.5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6zm3-.5a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5z" />
              <path fill-rule="evenodd"
                d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h3a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z" />
            </svg>

          </button>
          <br>

          <a [routerLink]="gotoDetail(post.id)" style="text-decoration: none;" pButton
            class="p-button-text p-button-md">

            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" class="bi bi-list"
              viewBox="0 0 16 16">
              <path fill-rule="evenodd"
                d="M2.5 12.5a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1h-10a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1h-10a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1h-10a.5.5 0 0 1-.5-.5z" />
            </svg> Details

          </a>

          <br>

          <a [routerLink]="gotoSections(post.id)" style="text-decoration: none;" pButton
            class="p-button-text p-button-md">

            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor"
              class="bi bi-journal-text" viewBox="0 0 16 16">
              <path d="M5 8h6v1H5V8zm0 2h6v1H5v-1z" />
              <path d="M3 0h10a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V1a1 1 0 0 1 1-1zm0 1v13h10V1H3z" />
            </svg>
            Sections

          </a>
          <br>


          <a [routerLink]="gotoPreview(post.id)" style="text-decoration: none;" pButton
            class="p-button-text p-button-md">

            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
            class="bi bi-journal-text" viewBox="0 0 16 16">
            <path d="M5 8h6v1H5V8zm0 2h6v1H5v-1z" />
            <path d="M3 0h10a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V1a1 1 0 0 1 1-1zm0 1v13h10V1H3z" />
          </svg>
            Preview

          </a>
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>



<app-shared-paginator [first]="first" [rows]="rows" [totalRecords]="totalRecords"
  (onPageChangeEmitter)="onPageChange($event)">
</app-shared-paginator>
< <p-toast position="bottom-right" [life]="20000" />
<p-confirmDialog />
